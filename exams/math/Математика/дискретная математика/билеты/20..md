source:  [[Математика/дискретная математика/Дискретная математика|Дискретная математика]]
tegs: #math 
### **Неупорядоченные разбиения множества на k непустых частей**

- ! **Тоже самое, что и числа Стирлинга**

**Неупорядоченные разбиения множества на $k$ непустых частей** — это разбиение множества $A$ на $k$ непустых, непересекающихся подмножеств $A_1, A_2, \dots, A_k$, таких что:

1. $A_i \neq \emptyset$ для всех $i = 1, 2, \dots, k$,
2. $A_i \cap A_j = \emptyset$ для всех $i \neq j$,
3. $\bigcup_{i=1}^k A_i = S$.

---

### **Числа Стирлинга второго рода**

Числа Стирлинга второго рода $S(n, k)$ обозначают количество разбиений множества из $n$ элементов на $k$ непустых частей.

---

#### **Явная формула**

Числа Стирлинга второго рода можно выразить с помощью следующей формулы: $$S(n, k) = \frac{1}{k!} \sum_{i=0}^k (-1)^i \binom{k}{i} (k-i)^n= \sum_{i=0}^k(-1)^i \frac{(k-i)^n}{i!(n-i)!}$$

---

#### **Рекуррентное соотношение**

Числа Стирлинга второго рода удовлетворяют рекуррентному соотношению: $$S(n, k) = k \cdot S(n-1, k) + S(n-1, k-1)$$
где:

- $S(n, k)$ — количество разбиений множества из $n$ элементов на $k$ частей,
- $S(0, 0) = 1$, $S(n, 0) = 0$ для $n > 0$, $S(0, k) = 0$ для $k > 0$.

**Идея:**

1. Первый член $k \cdot S(n-1, k)$ соответствует случаю, когда $n$-й элемент добавляется в одну из уже существующих $k$ частей.
2. Второй член $S(n-1, k-1)$ соответствует случаю, когда $n$-й элемент образует новую часть.

---

### **Неупорядоченные разбиения множества на произвольное число непустых частей**

Если число частей $k$ может быть произвольным (от $1$ до $n$), то общее количество разбиений множества из $n$ элементов определяется с помощью **чисел Белла**.

---

### **Числа Белла**

Числа Белла $B_n$ обозначают общее число всех возможных разбиений множества из $n$ элементов на непустые части. $$B_n = \sum_{k=1}^n S(n, k)=\sum_{k=1}^n\sum_{i=0}^k(-1)^i \frac{(k-i)^n}{i!(n-i)!}$$

---

#### **Рекуррентное соотношение для чисел Белла**

Числа Белла удовлетворяют следующему рекуррентному соотношению: $$B_{n+1} = \sum_{k=0}^n \binom{n}{k} B_k$$где $B_0 = 1$.

**Идея:** Число разбиений множества из $n+1$ элементов можно получить, добавляя $(n+1)$-й элемент к разбиениям всех подмножеств меньшего размера.

---

#### **Явная формула**

Числа Белла могут быть выражены через **ряд экспоненциальной генерации**: $$B_n = \frac{1}{e} \sum_{k=0}^\infty \frac{k^n}{k!}$$

---

### **Связь с отношениями эквивалентности**

Разбиение множества $S$ на $k$ непустых частей эквивалентно введению на $S$ отношения эквивалентности, где каждая часть разбиения соответствует одному классу эквивалентности. Таким образом:

1. Разбиение множества — это задание отношения эквивалентности.
2. Число Белла $B_n$ равно числу различных отношений эквивалентности на множестве из $n$ элементов.

---

### **Пример**

1. Для множества $S = {a, b, c}$ и $n = 3$:
    - $S(3, 1) = 1$ (всё множество в одной части),
    - $S(3, 2) = 3$ (разбиения $\{\{a\}, \{b, c\}\}$; $\{\{b\}, \{a, c\}\}$; $\{\{c\}, \{a, b\}\}$,
    - $S(3, 3) = 1$ (каждый элемент в своей части).
    - Число Белла: $B_3 = S(3, 1) + S(3, 2) + S(3, 3) = 1 + 3 + 1 = 5$.

2. Отношения эквивалентности на ${a, b, c}$:
    - **Одно множество (все элементы эквивалентны):**  
    Все элементы $a, b, c$ лежат в одном классе: $\{\{a, b, c\}\}$
    
	- **Два класса эквивалентности (два элемента эквивалентны, третий нет):**  
	Возможные разбиения: $\{\{a, b\}, \{c\}\}, \{\{a, c\}, \{b\}\}, \{\{b, c\}, \{a\}\}$
	Для первого разбиения $a$ и $b$ эквивалентны, а $c$ не эквивалентен им, и аналогично для других случаев.
	
	- **Три класса эквивалентности (все элементы эквивалентны только сами с собой):**  
	Каждый элемент $a, b, c$ образует свой собственный класс:$\{\{a\}, \{b\}, \{c\}\}$