source:  [[Математика/дискретная математика/Дискретная математика|Дискретная математика]]
tegs: #math 

# Полиномиальная теорема

## Формулировка
Полиномиальная теорема является обобщением бинома Ньютона для суммы большего числа переменных. Пусть есть $n$ переменных $x_1, x_2, \ldots, x_m$, тогда:
$$
(x_1 + x_2 + \ldots + x_m)^n = \sum_{k_1+k_2+\ldots+k_m=n} \frac{n!}{k_1!k_2!\ldots k_m!} x_1^{k_1} x_2^{k_2} \ldots x_m^{k_m},
$$
где сумма берётся по всем целым неотрицательным значениям $k_1, k_2, \ldots, k_m$, таким что $k_1 + k_2 + \ldots + k_m = n$.

## Комбинаторное доказательство
1. Рассмотрим выражение $(x_1 + x_2 + \ldots + x_m)^n$ как произведение $n$ одинаковых скобок:
   $$
   (x_1 + x_2 + \ldots + x_m)(x_1 + x_2 + \ldots + x_m)\ldots(x_1 + x_2 + \ldots + x_m).
   $$
2. Каждый член в раскрытии этого произведения получается путём выбора одного из $x_1, x_2, \ldots, x_m$ из каждой скобки.
3. Пусть $k_1$ раз выбирается $x_1$, $k_2$ раз \--- $x_2$ и так далее, с условием $k_1 + k_2 + \ldots + k_m = n$.
4. Число таких выборов равно числу перестановок $n$ объектов, где:
   - $k_1$ объектов одного типа,
   - $k_2$ объектов другого типа, и так далее.

   Общее число перестановок даётся формулой:
   $$
   \frac{n!}{k_1!k_2!\ldots k_m!}.
   $$

Таким образом, сумма всех таких слагаемых даёт:
$$
(x_1 + x_2 + \ldots + x_m)^n = \sum_{k_1+k_2+\ldots+k_m=n} \frac{n!}{k_1!k_2!\ldots k_m!} x_1^{k_1} x_2^{k_2} \ldots x_m^{k_m}.
$$

## Следствие: Малая теорема Ферма
Малая теорема Ферма является частным случаем полиномиальной теоремы, применённой к арифметике по модулю. Она гласит:

**Формулировка**: Если $p$ \-простое число и $a$ \-целое число, то:
$$
a^{p} \equiv a \pmod{p}.
$$
Обьяснение:
при делении $a^{p}$ на p остаток = a

### Доказательство
Рассмотрим выражение $(a_1 + a_2 + \ldots + a_n)^n$. По разложению через многочлен оно может быть записано следующим образом:

$$
(a_1 + a_2 + \ldots + a_n)^n = \sum \frac{n!}{n_1! n_2! \cdots n_k!} \cdot a_1^{n_1} \cdot a_2^{n_2} \cdots a_k^{n_k},
$$

где сумма берётся по всем наборам $n_1, n_2, \ldots, n_k$, таких что $n_1 + n_2 + \ldots + n_k = n$.

Пусть $a_1 = a_2 = \ldots = a_n = 1$. Тогда выражение упрощается:

$$
(a_1 + a_2 + \ldots + a_n)^n = n^n.
$$

С другой стороны, при подстановке $a_1 = a_2 = \ldots = a_n = 1$, все слагаемые в сумме, кроме одного, оказываются кратными $p$, где $p$ — простое число. Таким образом, можно записать:

$$
(a_1 + a_2 + \ldots + a_n)^n = a_n + px,
$$

где $x$ — некоторое целое число.

Следовательно, при делении на $p$ остаётся только главный член:

$$
a^p \equiv a \pmod{p}.
$$

Это и есть малая теорема Ферма.

## Пример использования полиномиальной теоремы
Рассмотрим разложение $(x + y + z)^3$:
$$
(x + y + z)^3 = \sum_{k_1+k_2+k_3=3} \frac{3!}{k_1!k_2!k_3!} x^{k_1} y^{k_2} z^{k_3}.
$$

Выпишем все слагаемые:
- Для $(k_1, k_2, k_3) = (3, 0, 0)$: $\frac{3!}{3!0!0!}x^3 = x^3$,
- Для $(k_1, k_2, k_3) = (2, 1, 0)$: $\frac{3!}{2!1!0!}x^2y = 3x^2y$,
- Для $(k_1, k_2, k_3) = (2, 0, 1)$: $\frac{3!}{2!0!1!}x^2z = 3x^2z$,
- Для $(k_1, k_2, k_3) = (1, 2, 0)$: $\frac{3!}{1!2!0!}xy^2 = 3xy^2$,
- Для $(k_1, k_2, k_3) = (1, 1, 1)$: $\frac{3!}{1!1!1!}xyz = 6xyz$,
- Для $(k_1, k_2, k_3) = (0, 3, 0)$: $\frac{3!}{0!3!0!}y^3 = y^3$,
- Для $(k_1, k_2, k_3) = (0, 2, 1)$: $\frac{3!}{0!2!1!}y^2z = 3y^2z$,
- Для $(k_1, k_2, k_3) = (0, 1, 2)$: $\frac{3!}{0!1!2!}yz^2 = 3yz^2$,
- Для $(k_1, k_2, k_3) = (0, 0, 3)$: $\frac{3!}{0!0!3!}z^3 = z^3$.

Итог:
$$
(x + y + z)^3 = x^3 + 3x^2y + 3x^2z + 3xy^2 + 6xyz + y^3 + 3y^2z + 3yz^2 + z^3.
$$
